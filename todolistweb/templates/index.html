<!DOCTYPE html>
<html>
    {% extends "base.html" %}
<title>To-Do List</title>
<main>
    {% block content %}
    {% with messages = get_flashed_messages() %}
    {% if messages %}
    <script>
            alert('{{ messages[0] }}');
    </script>
    {% endif %}
    {% endwith %}
    <h1>{{ title }}</h1>
    <div id="add-form" class="modal" style="display:block;">
        <form method="POST" action="{{ url_for('add_task') }}">
            <input class="input-task" type="text" name="task_description" placeholder="Введите задачу" required>
            <button type="submit">Добавить</button>
        </form>
    </div>
    <div id="task-list">
        {% for task in tasks %}
        <div class="task">
            <span class="task-number">{{loop.index}}.</span>
            <form class="complete_box" method="POST" action="{{ url_for('complete_task_form', task_id = loop.index0) }}">
                <input type="checkbox" onchange="this.form.submit()" name='completed' value="True" {% if task.completed %}checked{% endif %}>
            </form>
            {% if task.completed %}
            <s><span class="task-text">{{ task.description }}</span></s>
            {% else %}
            <span class="task-text">{{ task.description }}</span>
            {% endif %}
            <form method="POST" action="{{ url_for('delete_task', task_id=loop.index0) }}" class="delete-form">
                <button type="submit" class="delete-btn">❌</button>
            </form>
        </div>
        {% endfor %}
    </div>
    {% endblock %}
</main>
</html>
